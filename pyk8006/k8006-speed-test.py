#/usr/bin/env python
import spidev
import time

speed = 1

spi = spidev.SpiDev()
spi.open(0,0)
spi.max_speed_hz = speed
spi.mode = 0b00

start =     [0x23, 0x30, 0x35, 0x43, 0x56]
attempted = [0xAA, 0xAA, 0xAA, 0xAA, 0xAA]
text = [0x23, 0x31, 0x36, 0x56, 0x44, 0x20, 0x20, 0x44, 0xE9, 0x6D, 0x61, 0x72, 0x72, 0x61, 0x67, 0x65, 0x23, 0x30, 0x37, 0x4C, 0x30, 0x30, 0x30, 0x23, 0x30, 0x37, 0x4C, 0x31, 0x30, 0x31]
#\x23\x31\x36\x56\x44\x20\x20\x44\xE9\x6D\x61\x72\x72\x61\x67\x65
resp = attempted
while (attempted == resp) and (speed < 10000000):
    print speed
    resp = spi.xfer(start, speed, 50000)
    print [hex(i) for i in resp]
    speed += speed
    spi.max_speed_hz = speed
    
    read = spi.readbytes(20)
    print [hex(i) for i in read]

